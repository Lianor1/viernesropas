"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[3485],{3485:(v,m,d)=>{d.r(m),d.d(m,{LoginPageModule:()=>P});var t=d(1660),h=d(177),u=d(4341),l=d(4742),p=d(70),f=d(467),n=d(4438),b=d(8955);function M(s,a){if(1&s){const g=n.RV6();n.qex(0),n.j41(1,"ion-item")(2,"ion-label",4),n.EFF(3,"Nombres"),n.k0s(),n.j41(4,"ion-input",9),n.mxI("ngModelChange",function(o){n.eBV(g);const r=n.XpG();return n.DH7(r.nombres,o)||(r.nombres=o),n.Njj(o)}),n.k0s()(),n.j41(5,"ion-item")(6,"ion-label",4),n.EFF(7,"Apellidos"),n.k0s(),n.j41(8,"ion-input",10),n.mxI("ngModelChange",function(o){n.eBV(g);const r=n.XpG();return n.DH7(r.apellidos,o)||(r.apellidos=o),n.Njj(o)}),n.k0s()(),n.bVm()}if(2&s){const g=n.XpG();n.R7$(4),n.R50("ngModel",g.nombres),n.R7$(4),n.R50("ngModel",g.apellidos)}}const C=[{path:"",component:(()=>{var s;class a{constructor(e,o,r,i){(0,t.A)(this,"supabase",void 0),(0,t.A)(this,"router",void 0),(0,t.A)(this,"toastController",void 0),(0,t.A)(this,"loadingController",void 0),(0,t.A)(this,"email",""),(0,t.A)(this,"password",""),(0,t.A)(this,"nombres",""),(0,t.A)(this,"apellidos",""),(0,t.A)(this,"isLogin",!0),this.supabase=e,this.router=o,this.toastController=r,this.loadingController=i}onSubmit(){var e=this;return(0,f.A)(function*(){let o=null;try{if(o=yield e.loadingController.create({message:e.isLogin?"Iniciando sesi\xf3n...":"Registrando..."}),yield o.present(),e.isLogin){var r;const{data:i,error:c}=yield e.supabase.login(e.email,e.password);if(c)throw c;if(!i.user)throw new Error("No se encontr\xf3 informaci\xf3n del usuario");console.log("Login exitoso:",{user:i.user,metadata:i.user.user_metadata});const y=(null===(r=i.user.user_metadata)||void 0===r?void 0:r.role)||"usuario";e.router.navigate(["admin"===y?"/admin":"/home"])}else yield e.supabase.registro(e.email,e.password,{nombres:e.nombres,apellidos:e.apellidos}),e.presentToast("Registro exitoso. Por favor, inicia sesi\xf3n."),e.isLogin=!0}catch(i){let c="Error en la autenticaci\xf3n";"Invalid login credentials"===i.message?c="Credenciales inv\xe1lidas":"Email not confirmed"===i.message&&(c="Por favor, confirma tu correo electr\xf3nico"),e.presentToast(c),console.error("Error completo:",i)}finally{o&&(yield o.dismiss())}})()}toggleAuth(){this.isLogin=!this.isLogin}presentToast(e){var o=this;return(0,f.A)(function*(){(yield o.toastController.create({message:e,duration:2e3,position:"bottom"})).present()})()}}return s=a,(0,t.A)(a,"\u0275fac",function(e){return new(e||s)(n.rXU(b.w),n.rXU(p.Ix),n.rXU(l.K_),n.rXU(l.Xi))}),(0,t.A)(a,"\u0275cmp",n.VBU({type:s,selectors:[["app-login"]],decls:21,vars:6,consts:[[1,"ion-padding"],[1,"ion-text-center"],[3,"ngSubmit"],[4,"ngIf"],["position","floating"],["type","email","name","email","required","",3,"ngModelChange","ngModel"],["type","password","name","password","required","",3,"ngModelChange","ngModel"],["expand","block","type","submit",1,"ion-margin-top"],["expand","block","fill","clear",3,"click"],["type","text","name","nombres","required","",3,"ngModelChange","ngModel"],["type","text","name","apellidos","required","",3,"ngModelChange","ngModel"]],template:function(e,o){1&e&&(n.j41(0,"ion-content")(1,"div",0)(2,"ion-card")(3,"ion-card-header")(4,"ion-card-title",1),n.EFF(5),n.k0s()(),n.j41(6,"ion-card-content")(7,"form",2),n.bIt("ngSubmit",function(){return o.onSubmit()}),n.DNE(8,M,9,2,"ng-container",3),n.j41(9,"ion-item")(10,"ion-label",4),n.EFF(11,"Email"),n.k0s(),n.j41(12,"ion-input",5),n.mxI("ngModelChange",function(i){return n.DH7(o.email,i)||(o.email=i),i}),n.k0s()(),n.j41(13,"ion-item")(14,"ion-label",4),n.EFF(15,"Contrase\xf1a"),n.k0s(),n.j41(16,"ion-input",6),n.mxI("ngModelChange",function(i){return n.DH7(o.password,i)||(o.password=i),i}),n.k0s()(),n.j41(17,"ion-button",7),n.EFF(18),n.k0s()(),n.j41(19,"ion-button",8),n.bIt("click",function(){return o.toggleAuth()}),n.EFF(20),n.k0s()()()()()),2&e&&(n.R7$(5),n.SpI(" ",o.isLogin?"Iniciar Sesi\xf3n":"Crear Cuenta"," "),n.R7$(3),n.Y8G("ngIf",!o.isLogin),n.R7$(4),n.R50("ngModel",o.email),n.R7$(4),n.R50("ngModel",o.password),n.R7$(2),n.SpI(" ",o.isLogin?"Iniciar Sesi\xf3n":"Registrarse"," "),n.R7$(2),n.SpI(" ",o.isLogin?"\xbfNo tienes cuenta? Reg\xedstrate":"\xbfYa tienes cuenta? Inicia sesi\xf3n"," "))},dependencies:[h.bT,u.qT,u.BC,u.cb,u.YS,u.vS,u.cV,l.Jm,l.b_,l.I9,l.ME,l.tN,l.W9,l.$w,l.uz,l.he,l.Gw],styles:["ion-content[_ngcontent-%COMP%]{--background: url(https://image.cdn2.seaart.me/temp-convert-webp/highwebp/2024-11-22/ct066ele878c73c6tp00-2/4ae21d9f1144c7d5e51c8d213dd8f4a7_low.webp) no-repeat center center fixed;--background-size: cover}ion-content[_ngcontent-%COMP%]   .ion-padding[_ngcontent-%COMP%]{height:100%;display:flex;align-items:center;justify-content:center}ion-card[_ngcontent-%COMP%]{width:90%;max-width:400px;margin:0 auto;box-shadow:none;border-radius:8px;box-shadow:0 4px 6px #0000001a}form[_ngcontent-%COMP%]{margin-top:16px}ion-button[type=submit][_ngcontent-%COMP%]{margin-top:24px}"]})),a})()}];let L=(()=>{var s;class a{}return s=a,(0,t.A)(a,"\u0275fac",function(e){return new(e||s)}),(0,t.A)(a,"\u0275mod",n.$C({type:s})),(0,t.A)(a,"\u0275inj",n.G2t({imports:[p.iI.forChild(C),p.iI]})),a})(),P=(()=>{var s;class a{}return s=a,(0,t.A)(a,"\u0275fac",function(e){return new(e||s)}),(0,t.A)(a,"\u0275mod",n.$C({type:s})),(0,t.A)(a,"\u0275inj",n.G2t({imports:[h.MD,u.YN,l.bv,L]})),a})()}}]);